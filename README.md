## packages

<!-- This file was generated by Ansigenome. Do not edit this file directly but
     instead have a look at the files in the ./meta/ directory. -->

[![Travis CI](http://img.shields.io/travis/ypid/ansible-packages.svg?style=flat)](http://travis-ci.org/ypid/ansible-packages)
[![Platforms](http://img.shields.io/badge/platforms-debian%20/%20ubuntu-lightgrey.svg?style=flat)](#)
[![GitHub Tags](https://img.shields.io/github/tag/ypid/ansible-packages.svg)](https://github.com/ypid/ansible-packages)
[![GitHub Stars](https://img.shields.io/github/stars/ypid/ansible-packages.svg)](https://github.com/ypid/ansible-packages)

Overengineered package selection framework.

This role allows you to select/manage packages over a heterogeneous set of
hosts using Ansible.

It was written to allow to have the maximum level of flexibility in regards
to selecting which packages should be installed on which host. Normally
Ansible works by making host groups in your inventory and configuring the
packages to install for those groups. This has certain downsides when the
complexity increases. For example, imagine that one of those hosts runs a
different distribution/OS. Also, when you have groups of packages in the
order of hundreds (to keep it generic), you would probably mess up your
Ansible inventory and your configuration would be distributed over hundreds
of files. Also this approach would not be practical because seeing all
those package groups which apply for a given host is not easy to
understand when you just want the big picture of software installed on this
host. Therefore this role puts its focus on packages, groups of packages
and classes of hosts while allowing to overwrite package names to match the
naming used by different distributions or versions of distributions.

### Why make it that complicated?

Well, it started when I found more and more nice software in Debian
repositories combined with the need to install/provision different kinds of
systems with a certain subset of the software I know/have tested.

Those different systems include:

* My workstation
* Servers/VMs/virtual appliances
* Workstation systems for other people
* [Linux based systems for schools](https://github.com/ypid/ansible-linuxmuster_net_client)
* Live systems

### History

Before I knew Ansible, I had a shell script which asked me which
categories I wanted to install.
Now that I know Ansible I have something slightly more advanced :wink:

### Variable prefixes

All variables are prefixed by the name of this role to avoid conflicts.

Furthermore, there are a number of variable namespaces:

* single: Name of a single package defaulting to the name in Debian stable.
  This can be used if other distributions (for instance Ubuntu) call a
  package differently.

* group: A set of packages which fit in the same topic.

  * core: CLI only, does not require X

* class: List of all packages for a specific class of host.

* deploy: Options related to the installation and removal of packages as
  provided by the package management modules in Ansible.

It is preferred when group names match
[Debtags](https://wiki.debian.org/Debtags) for the packages they group
together. For example `field`.

### Variable suffixes

For `group` variables, certain suffixes are defined:

* minimal: Minimal set of packages of the group.
* basic: Basic set of packages of the group (including minimal).
* additional: Additional set of packages.
* full: Union of the minimal, basic and all the additional sets.

### How to deal with the abstraction this role introduces?

There is a export feature available which you can use to generate package
lists for the different classes. Furthermore you can keep those lists under
version control so you can see what a change to a package group is
resulting in for the different classes and if that is what you intended.

<!-- Check the [docs][/docs/getting-started.rst] and the [example -->
<!-- playbooks][/playbooks] for more details. -->

Check the [example playbooks][/playbooks] to get started.

### Role variables

Check the [defaults/main.yml][] for a list of all default variables and
package presets available.

### Requirements

This role makes extensive use of some recently introduced features of
Ansible 2. One of those features, namely iterating over included
tasks multiple times with the `when_*` statement had a bug so this role
requires at least Ansible 2.1.

Additionally, this role uses features recently introduced in Jinja2, namely
the `equalto` filter which was released with
[Jinja 2.8](http://jinja.pocoo.org/docs/dev/changelog/#version-2-8).
Jinja 2.8 is currently only
[available in Debian Stretch](https://packages.debian.org/search?keywords=python-jinja2).

[/docs/getting-started.rst]: https://github.com/ypid/ansible-packages/blob/master/docs/getting-started.rst
[/playbooks]: https://github.com/ypid/ansible-packages/tree/master/playbooks
[defaults/main.yml]: https://github.com/ypid/ansible-packages/blob/master/defaults/main.yml



List of internal variables used by the role:

    packages__export_key_name
    packages__targets
    packages__debconf_settings_combined
    ansible_distribution
    packages__classes_combined
    packages__blacklist_by_vars_combined
    packages__targets_real


### Authors and license

`packages` role was written by:

- [Robin Schneider](https://github.com/ypid) | [e-mail](mailto:ypid@riseup.net)

License: [AGPLv3](https://tldrlegal.com/license/gnu-affero-general-public-license-v3-%28agpl-3.0%29)

***

README generated by [Ansigenome](https://github.com/nickjj/ansigenome/).
